<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Simulate data from IV model — simulate_data • Bounds in Two-Sample Mendelian Randomization With Summary Statistics</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Simulate data from IV model — simulate_data" />
<meta property="og:description" content="This function allows the user to simulate data from an IV model
with an arbitrary number of IVs with the option to include IVs
that are dependent on each other, and IVs with a direct effect
on the outcome." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">Bounds in Two-Sample Mendelian Randomization With Summary Statistics</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/ATEBounds.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="divider"></li>
    <li class="dropdown-header">Exploration of Bounds</li>
    <li>
      <a href="../articles/bounds_from_bivariate.html">Bounds using Two-Sample Data</a>
    </li>
    <li>
      <a href="../articles/bounds_from_trivariate.html">Utilize two-sample data two get potential one-sample bounds</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">"Power" analysis</li>
    <li>
      <a href="../articles/power_sims.html">Monte carlo integration</a>
    </li>
    <li>
      <a href="../articles/power_sims_figures.html">Coverage of Null Effect</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">Two-Sample Bounds using Multiple Instruments</li>
    <li>
      <a href="../articles/multiple_IVs_sims.html">Two-Sample Bounds using Multiple IV: Monte carlo integration and data prep</a>
    </li>
    <li>
      <a href="../articles/multiple_IVs_figures.html">Two-Sample Bounds using Multiple IV: Figures</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">How-To's</li>
    <li>
      <a href="../articles/polymake_example.html">Polymake Example</a>
    </li>
    <li>
      <a href="../articles/get_bounds.html">How to use the `get_bounds` function</a>
    </li>
    <li>
      <a href="../articles/example_analysis.html">Example Analysis of Data from the IEU GWAS Database</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/rmtrane/ATEBounds/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Simulate data from IV model</h1>
    <small class="dont-index">Source: <a href='https://github.com/rmtrane/ATEBounds/blob/master/R/simulate_data.R'><code>R/simulate_data.R</code></a></small>
    <div class="hidden name"><code>simulate_data.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function allows the user to simulate data from an IV model
with an arbitrary number of IVs with the option to include IVs
that are dependent on each other, and IVs with a direct effect
on the outcome.</p>
    </div>

    <pre class="usage"><span class='fu'>simulate_data</span><span class='op'>(</span>
  sample_size <span class='op'>=</span> <span class='fl'>10000</span>,
  IVs_ps <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.5</span>, <span class='fl'>0.5</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.5</span>, <span class='fl'>0.5</span><span class='op'>)</span><span class='op'>)</span>,
  indIVs_on_X <span class='op'>=</span> <span class='cn'>NULL</span>,
  indIVs_on_Y <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>IVs_ps</span><span class='op'>)</span><span class='op'>)</span>,
  U <span class='op'>=</span> <span class='fu'>distributions3</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/distributions3/man/Bernoulli.html'>Bernoulli</a></span><span class='op'>(</span><span class='fl'>0.5</span><span class='op'>)</span>,
  X_intercept <span class='op'>=</span> <span class='fl'>0.05</span>,
  U_on_X <span class='op'>=</span> <span class='fl'>0.1</span>,
  Y_intercept <span class='op'>=</span> <span class='fl'>0.05</span>,
  X_on_Y <span class='op'>=</span> <span class='fl'>0.05</span>,
  U_on_Y <span class='op'>=</span> <span class='fl'>0.1</span>,
  rho <span class='op'>=</span> <span class='cn'>NULL</span>,
  depIVs_on_X <span class='op'>=</span> <span class='cn'>NULL</span>,
  dep_probs <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0.5</span>, <span class='fl'>0.5</span><span class='op'>)</span>,
  depIVs_on_Y <span class='op'>=</span> <span class='cn'>NULL</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>sample_size</th>
      <td><p>default 10000; number of observations to simulate.</p></td>
    </tr>
    <tr>
      <th>IVs_ps</th>
      <td><p>list of numeric vectors. Length of list specifies number of independent IVs to include. Each vector
gives probabilities of \(P(Z = i)\), and must therefore sum to 1.</p></td>
    </tr>
    <tr>
      <th>indIVs_on_X</th>
      <td><p>numeric vector specifying the effects of the independent IVs on X (i.e. \(\gamma_1, ..., \gamma_n\)).</p></td>
    </tr>
    <tr>
      <th>indIVs_on_Y</th>
      <td><p>numeric vector specifying the effects of the independent IVs on Y (i.e. \(\beta_1, ..., \beta_n\)). Default: 0</p></td>
    </tr>
    <tr>
      <th>U</th>
      <td><p><code>distributions3</code> object specifying the distribution to be used for the unmeasured confounder. Default is <code>Bernoulli(0.5)</code>.</p></td>
    </tr>
    <tr>
      <th>X_intercept</th>
      <td><p>numeric value to use for \(\gamma_x\). Default: 0.05.</p></td>
    </tr>
    <tr>
      <th>U_on_X</th>
      <td><p>numeric value to use for \(\alpha_U\). Default: 0.1.</p></td>
    </tr>
    <tr>
      <th>Y_intercept</th>
      <td><p>numeric value to use for \(\gamma_y\). Default: 0.05.</p></td>
    </tr>
    <tr>
      <th>X_on_Y</th>
      <td><p>numeric value to use for \(\beta_X\). Default: 0.05.</p></td>
    </tr>
    <tr>
      <th>U_on_Y</th>
      <td><p>numeric value to use for \(\beta_U\). Default: 0.1.</p></td>
    </tr>
    <tr>
      <th>rho</th>
      <td><p>numeric value specifying \(\rho\). Default: NULL.</p></td>
    </tr>
    <tr>
      <th>depIVs_on_X</th>
      <td><p>numeric vector specifying the effects of the dependent IVs on X (i.e. \(\alpha_{D1}\) and \(\alpha_{D2}\)).</p></td>
    </tr>
    <tr>
      <th>dep_probs</th>
      <td><p>numeric vector. The length specifies the number of categories for the IVs, and the values give \(P(Z_i = z)\).</p></td>
    </tr>
    <tr>
      <th>depIVs_on_Y</th>
      <td><p>numeric vector specifying the effects of the dependent IVs on Y (i.e. \(\beta_{D1}\) and \(\beta_{D2}\)).</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Data are simulated from a logistic model as follows:</p><ul>
<li><p>A binary confounder \(U\) is simulated with user specified \(P(U = 1)\).</p></li>
<li><p>A user specified number of independent IVs (\(Z_1, ..., Z_p\)) that are either
di- or trichotomous. Probabilities \(P(Z_j = z), z=0,1\) (and \(P(Z_j = 2)\) if trichotomous
case is considered) are specified by the user.</p></li>
<li><p>Optionally, a pair of dependent IVs, \(Z_{D1}, Z_{D2}\), simulated as follows:</p><ul>
<li><p>User specifies \(\rho\)</p></li>
<li><p>\((N_{D1}, N_{D2}) \sim N\left(\begin{pmatrix} 0 \\ 0 \end{pmatrix},\begin{pmatrix} 1 &amp; \rho \\ \rho &amp; 1 \end{pmatrix} \right)\),
then $$
          Z_{Di} = \left\{\begin{array}{cl} 0 &amp; \text{ if } N_{Di} \le z_{p_1} \\ 1 &amp; \text{ if } z_{p_0} &lt; N_{Di} \le z_{p_0 + p_1} \\ 2 &amp; \text{ otherwise} \end{array}  \right. ,
        $$ where \(z_k\) is the \(k'th\) percentile of the standard normal (\(P(Z \le z_k) = k\) when \(Z \sim N(0,1)\)).</p></li>
</ul></li>
<li><p>A binary treatment is simulated as \(X | Z_1,...,Z_p, Z_{D1}, Z_{D2}, U \sim \text{Bernoulli}(p_X)\),
where $$\text{logit}(p_X) = \gamma_0 + \gamma_1 \cdot Z_1 + ... + \gamma_p \cdot Z_p + \gamma_{D1} \cdot Z_{D1} + \gamma_{D2} \cdot Z_{D2} + \gamma_U \cdot U$$,
and all parameters \(\gamma_j\) are user specified.</p></li>
<li><p>A binary outcome is simulated as \(Y | X, U, Z_1,...,Z_p, Z_{D1}, Z_{D2}, U \sim \text{Bernoulli}(p_Y)\),
where $$\text{logit}(p_Y) = \beta_0 + \beta_X \cdot X + \beta_1 \cdot Z_1 + ... + \beta_p \cdot Z_p + \beta_{D1} \cdot Z_{D1} + \beta_{D2} \cdot Z_{D2} + \beta_U \cdot U$$,
and all parameters \(\beta_j\) are user specified.</p></li>
</ul>


  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Ralph Møller Trane.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


